# Auth Service 프로젝트 기획안

## 1. 프로젝트 개요
Auth Service는 기업이 사내 시스템 혹은 외부 파트너 애플리케이션에 신뢰성 있는 인증·인가 기능을 손쉽게 도입할 수 있도록 지원하는 독립형 계정 관리 플랫폼입니다. REST API와 SSR UI를 함께 제공해 다양한 클라이언트에서 공통 플로우를 재사용하며, 5단계 RBAC 정책으로 권한을 세밀하게 제어합니다.

## 2. 비즈니스 배경 및 문제 정의
- 각 서비스마다 회원가입/로그인 기능을 반복 구현하면 개발 기간이 지연되고 품질 편차가 커집니다.
- 정보보호 요구 사항(비밀번호 관리, 토큰 보안, 접근 제어)을 일관되게 유지하기 어렵습니다.
- 중앙 집중식 계정 관리가 없어 사용자 권한 변경 내역을 추적하거나 감사하기 힘듭니다.

Auth Service는 이러한 문제를 해결하기 위해 재사용 가능한 인증 백엔드와 관리자용 UI를 제공하여 운영 효율과 보안 수준을 동시에 향상시키는 것을 목표로 합니다.

## 3. 목표
1. **빠른 도입**: 신규 제품이 최소한의 설정으로 인증 기능을 붙일 수 있도록 템플릿과 명확한 문서를 제공한다.
2. **보안 강화**: 표준화된 비밀번호 해싱, JWT 관리, RBAC를 통해 규제와 보안 정책을 준수한다.
3. **운영 효율**: 사용자·권한 변경을 중앙에서 관리하며, 감사 로그 및 모니터링 통합에 용이한 구조를 갖춘다.
4. **확장성 확보**: 멀티 테넌시 및 외부 연동을 고려한 API 우선 설계로 미래 기능 추가를 쉽게 한다.

## 4. 주요 이해관계자 및 사용자 페르소나
| 페르소나 | 니즈 | 기대 효과 |
| --- | --- | --- |
| 제품 백엔드 개발자 | 인증 기능을 빠르게 통합 | API와 SDK를 통해 반복 개발 비용 절감 |
| 보안 관리자 | 권한 정책 및 감사 추적 | RBAC 대시보드와 로그를 통한 컴플라이언스 확보 |
| 서비스 운영자 | 사용자 계정 관리 | UI 기반 계정 생성·비활성화로 운영 효율 상승 |
| 최종 사용자 | 안전하고 매끄러운 로그인 경험 | 단일 계정으로 여러 서비스 접근 가능 |

## 5. 범위 및 핵심 기능
- **사용자 관리**: 회원가입, 이메일 기반 로그인, 비밀번호 변경/재설정(차후 기능), 계정 비활성화.
- **권한 관리**: 5단계 RBAC 레벨 부여, 권한별 메뉴 노출 제어, 관리자 전용 화면 보호.
- **세션·토큰 관리**: JWT 발급/갱신, 로그아웃 처리, 토큰 만료 설정.
- **통합 인터페이스**: REST API, Swagger/Redoc 문서, SSR 기반 로그인·대시보드 UI.
- **운영 도구**: 모니터링 훅, 감사 로그(확장 예정), 환경별 설정 템플릿.

## 6. 기술 스택 및 도구
- **백엔드**: FastAPI, SQLAlchemy, Pydantic, Passlib, PyJWT
- **프런트(SSR)**: Jinja2, Tailwind 기반 커스텀 CSS(경량 스타일)
- **데이터베이스**: SQLite(기본), PostgreSQL/MySQL 등으로 교체 가능
- **CI/CD & 품질**: pytest, HTTPX, GitHub Actions(향후), pre-commit 훅(확장 가능)

## 7. 시스템 아키텍처 개요
```
┌────────────────────┐      ┌───────────────────────┐
│   Client Apps      │<---->│  Auth Service API     │
│ (Web, Mobile, etc.)│ REST │ (FastAPI + Services)  │
└────────────────────┘      └──────────┬────────────┘
                                        │
                                        ▼
                              ┌────────────────────┐
                              │    Database        │
                              │ (SQLite/External)  │
                              └────────────────────┘
                                        │
                                        ▼
                              ┌────────────────────┐
                              │ Monitoring / Logs  │
                              └────────────────────┘
```
- API 계층은 `app/api` 모듈에서 HTTP 요청을 처리하고 서비스 계층에 위임합니다.
- 서비스 계층은 도메인 로직(JWT 발급, RBAC 검사)을 수행하며, 리포지토리를 통해 데이터 계층과 통신합니다.
- SSR 라우트(`app/web`)는 공통 템플릿과 스타일을 활용해 로그인/회원가입/대시보드를 제공합니다.

## 8. 데이터 모델 개요
| 테이블 | 주요 필드 | 설명 |
| --- | --- | --- |
| `users` | `id`, `email`, `hashed_password`, `role_level`, `is_active`, `created_at` | 사용자 기본 정보와 권한 레벨 저장 |
| (추가 예정) `audit_logs` | `id`, `user_id`, `action`, `metadata`, `created_at` | 권한 변경 및 주요 이벤트 추적 |

## 9. 개발 일정(예시)
| 스프린트 | 기간 | 주요 산출물 |
| --- | --- | --- |
| Sprint 1 | 주 1–2 | 요구사항 확정, DB 스키마 정의, 기본 FastAPI 프로젝트 세팅 |
| Sprint 2 | 주 3–4 | 인증 API(회원가입, 로그인), JWT 발급/검증, 기본 테스트 |
| Sprint 3 | 주 5–6 | RBAC 도입, 권한 레벨별 보호 라우트, 사용자 관리 UI |
| Sprint 4 | 주 7–8 | 운영 도구(환경 설정, 로깅), 배포 스크립트, 고도화 테스트 |

## 10. 운영 및 배포 전략
- **환경 분리**: 개발/스테이징/프로덕션 환경을 분리하고 `.env` 템플릿을 환경별로 관리.
- **배포 파이프라인**: 컨테이너 이미지 빌드 후 CI/CD로 자동 배포(예: GitHub Actions → AWS ECS/Kubernetes) 검토.
- **모니터링**: 서비스 로그는 중앙 로깅 시스템으로 집계, Prometheus/Grafana로 메트릭 수집.
- **보안 관리**: 시크릿은 Vault/Parameter Store에 저장, 정기적인 키 로테이션 수행.

## 11. 위험 요소 및 대응 계획
| 위험 | 영향 | 대응 전략 |
| --- | --- | --- |
| 의존성 보안 취약점 | 사용자 데이터 유출 가능 | 정기적인 SCA(Software Composition Analysis) 및 보안 패치 적용 |
| RBAC 정책 오구현 | 권한 오남용/서비스 장애 | 자동화 테스트 강화, 정책 변경 시 코드 리뷰 필수화 |
| 확장성 저하 | 사용자 증가 시 응답 지연 | 수평 확장을 위한 무상태 설계, 캐싱/큐 도입 검토 |
| 운영 실수 | 서비스 중단 | 배포 자동화와 롤백 전략 마련, 문서화된 운영 매뉴얼 제공 |

## 12. 성공 지표(KPI)
- 신규 서비스가 Auth Service API를 통해 인증을 붙이는 평균 기간 < **3일**
- 월간 사용자 로그인 성공률 **99.9%** 이상 유지
- 보안 사고/권한 오남용 건수 **0건** 유지
- 분기별 감사 로그 누락률 **1% 미만**

## 13. 향후 로드맵 아이디어
- 소셜 로그인 및 SSO 연동(OAuth2, SAML)
- 감사 로그 대시보드 및 알림 시스템
- 사용자 자기 진단(Self-service) 비밀번호 재설정
- 멀티 테넌시 지원 및 조직 단위 권한 관리

---
본 기획안은 초기 제품 방향성을 정립하기 위한 자료이며, 실제 개발 단계에서 이해관계자 협의를 통해 우선순위와 세부 요구사항을 조정합니다.